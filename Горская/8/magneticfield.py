"""
Реализация задачи синтеза магнитного поля на оси соленоида.
Мы рассчитываем магнитное поле B вдоль оси конечного соленоида по формуле:

   B(z) = (μ0 * n * I)/2 * { [ (z + L/2) / sqrt((z + L/2)**2 + R**2) ] - [ (z - L/2) / sqrt((z - L/2)**2 + R**2) ] }

где:
  μ0  — магнитная постоянная (4π×10⁻⁷ [T·m/A]),
  I   — ток в соленоиде,
  n   — число витков на единицу длины (N / L),
  L   — длина соленоида,
  R   — радиус соленоида,
  z   — координата по оси (при этом ось соленоида симметричная относительно z=0; соленоид занимает от -L/2 до L/2).
"""

import numpy as np
import matplotlib.pyplot as plt

# Определяем магнитную постоянную μ0 (в Т·м/A)
mu0 = 4 * np.pi * 1e-7  # 4π×10⁻⁷ T·m/A

# Задаем параметры соленоида:
I  = 5.0        # Ток (Амперы)
L  = 0.5        # Длина соленоида (метры)
N  = 500        # Общее число витков
R  = 0.1        # Радиус соленоида (метры)
n  = N / L     # Число витков на метр (здесь N/L)

def magnetic_field_along_axis(z, R=R, L=L, n=n, I=I, mu0=mu0):
    """
    Вычисляет магнитное поле B вдоль оси соленоида в точке с координатой z.
    
    Аргументы:
      z   - позиция вдоль оси (метры). Может быть как число, так и NumPy-массив.
      R   - радиус соленоида.
      L   - длина соленоида.
      n   - число витков на единицу длины.
      I   - ток в соленоиде.
      mu0 - магнитная постоянная.
    
    Возвращает:
      B(z) - магнитное поле (в Теслах) в точке z, вычисленное по формуле:
             B(z) = (μ0 * n * I)/2 * { [ (z + L/2) / sqrt((z + L/2)**2 + R**2) ] -
                                         [ (z - L/2) / sqrt((z - L/2)**2 + R**2) ] }
    """
    # Определяем границы соленоида относительно центра:
    z1 = -L/2
    z2 = L/2
    # Вычисляем выражения для левой и правой границы
    term1 = (z - z1) / np.sqrt((z - z1)**2 + R**2)
    term2 = (z - z2) / np.sqrt((z - z2)**2 + R**2)
    B = 0.5 * mu0 * n * I * (term1 - term2)
    return B

# Для отрисовки графика зададим диапазон по оси z.
# Берем диапазон от -L (или даже немного больше) до +L, а также расширим границы, чтобы увидеть поле "вдали" от соленоида.
z_min = -L
z_max = L
# Для более детального отображения можно взять, например, 500 точек
z_values = np.linspace(z_min, z_max, 500)
B_values = magnetic_field_along_axis(z_values)

# ---------------------------------------------------------------------------------
# Отрисовка графика магнитного поля вдоль оси соленоида
# ---------------------------------------------------------------------------------
plt.figure(figsize=(10, 5))
plt.plot(z_values, B_values, 'b-', linewidth=2, label='Магнитное поле B(z)')
plt.title('Магнитное поле вдоль оси соленоида')
plt.xlabel('z (м)')
plt.ylabel('B (Тл)')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()

# ---------------------------------------------------------------------------------
# Дополнительная визуализация: Схематичное изображение соленоида и направления поля
# ---------------------------------------------------------------------------------
plt.figure(figsize=(8, 8))
# Рисуем соленоид в виде прямоугольника (силовой сектор)
# Соленоид расположен по оси z, с центром в 0, от -L/2 до L/2; его радиус R задает "ширину" по оси x.
plt.plot([-R, -R, R, R, -R], [-L/2, L/2, L/2, -L/2, -L/2], 'k-', linewidth=2, label="Соленоид")
# Отображаем ось z
plt.axvline(0, color='gray', linestyle='--')
plt.title('Схематичное изображение соленоида')
plt.xlabel('x (м)')
plt.ylabel('z (м)')
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()

# ---------------------------------------------------------------------------------
# Пошаговое объяснение:
#
# 1. В этом коде мы сначала задаём параметры соленоида:
#    - Ток I, длина L, число витков N и радиус R.
#    - Расчет числа витков на метр n = N / L.
#
# 2. Функция magnetic_field_along_axis(z, ...) реализует известную аналитическую формулу
#    для расчёта магнитного поля вдоль оси конечного соленоида.
#    Формула учитывает, что соленоид имеет границы в точках z = -L/2 и z = L/2.
#
# 3. Для построения графика задаётся диапазон значений по оси z от -L до L.
#    Вычисляются значения магнитного поля B(z) для 500 точек.
#
# 4. Первый график показывает зависимость магнитного поля B от координаты z вдоль оси соленоида.
#
# 5. Второй график – это схематичное представление соленоида, нарисованного в виде прямоугольника,
#    где по оси z отображает диапазон соленоида, а по оси x – радиус.
#
# Такой подход позволяет наглядно увидеть в какой области находится соленоид,
# а также понять, как изменяется магнитное поле вдоль его оси.
#
# Если необходимо, можно расширить диапазон z, добавить больше параметров,
# или построить дополнительные графики (например, 3D-изображение поля).
# ---------------------------------------------------------------------------------
